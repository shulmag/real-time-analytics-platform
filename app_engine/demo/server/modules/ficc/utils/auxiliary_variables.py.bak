'''
Author: Developer Shayaan
Date: 2021-12-17
Last Editor: Developer Ray
Last Edit Date: 2025-01-28
'''

NUM_OF_DAYS_IN_YEAR = 360

IS_BOOKKEEPING = 'is_bookkeeping'
IS_SAME_DAY = 'is_same_day'
IS_REPLICA = 'is_replica'
NTBC_PRECURSOR = 'ntbc_precursor'
REPLICA_COUNT = 'replica_count'


import numpy as np
from modules.ficc.utils.trade_mapping import TRADE_TYPE_MAPPING, TRADE_TYPE_CROSS_PRODUCT_MAPPING
from modules.ficc.utils.diff_in_days import diff_in_days_two_dates

#This is for testing purposes comment when deploying
# from utils.trade_mapping import TRADE_TYPE_MAPPING, TRADE_TYPE_CROSS_PRODUCT_MAPPING
# from utils.diff_in_days import diff_in_days_two_dates

def quantity_diff(par_traded_diff):
    MINIMUM_PAR_TRADED_DIFF_BETWEEN_TWO_BONDS = 100
    sign = np.sign(par_traded_diff)
    if abs(par_traded_diff) < MINIMUM_PAR_TRADED_DIFF_BETWEEN_TWO_BONDS: return 0    # use 0 to represent that the quantites are very close
    else: return float(sign * np.log10(abs(par_traded_diff)))    # wrap in `float(...)` to convert Decimal type to float type

flatten = lambda lst: [item for sublst in lst for item in sublst]


get_neighbor_feature = lambda feature: lambda curr, neighbor: neighbor[feature]

RELATED_TRADE_FEATURE_FUNCTIONS = {'yield_spread': get_neighbor_feature('yield_spread'), 
                                   'treasury_spread': get_neighbor_feature('ficc_treasury_spread'), 
                                   'quantity': get_neighbor_feature('quantity'), 
                                   'quantity_diff': lambda curr, neighbor: quantity_diff(10 ** neighbor['quantity'] - 10 ** curr['quantity']), 
                                   'trade_type1': lambda curr, neighbor: TRADE_TYPE_MAPPING[neighbor['trade_type']][0], 
                                   'trade_type2': lambda curr, neighbor: TRADE_TYPE_MAPPING[neighbor['trade_type']][1], 
                                   'seconds_ago': lambda curr, neighbor: np.log10(1 + (curr['trade_datetime'] - neighbor['trade_datetime']).total_seconds()), 
                                   'settlement_date_to_calc_date': lambda curr, neighbor: np.log10(1 + diff_in_days_two_dates(neighbor['calc_date'], neighbor['settlement_date'], convention='exact')), 
                                   'calc_day_cat': get_neighbor_feature('calc_day_cat'), 
                                   'trade_type_past_latest': lambda curr, neighbor: TRADE_TYPE_CROSS_PRODUCT_MAPPING[neighbor['trade_type'] + curr['trade_type']], 
                                   'same_day': lambda curr, neighbor: int(neighbor['trade_date'] == curr['trade_date'])}

RELATED_TRADE_FEATURE_PREFIX = 'related_last_'
RELATED_TRADE_BINARY_FEATURES = ['same_day']    # will be replaced by the column name for every past related trade
RELATED_TRADE_CATEGORICAL_FEATURES = ['calc_day_cat', 'trade_type_past_latest']    # will be replaced by the column name for every past related trade
RELATED_TRADE_NON_CAT_FEATURES = ['yield_spread', 'treasury_spread', 'quantity', 'quantity_diff', 'seconds_ago', 'settlement_date_to_calc_date']    # will be replaced by the column name for every past related trade
CATEGORICAL_REFERENCE_FEATURES_PER_RELATED_TRADE = ['rating', 'incorporated_state_code']    # need to be separated from RELATED_TRADE_CATEGORICAL_FEATURES since we create feature functions with these names using `get_neighbor_feature`
NUM_RELATED_TRADES = 1

get_appended_feature_name = lambda idx, feature_name='', prefix='': f'{idx + 1}{prefix}{feature_name}' if idx != 0 else f'{prefix}{feature_name}'
related_trade_features = lambda features: flatten([[get_appended_feature_name(idx, feature, RELATED_TRADE_FEATURE_PREFIX) for feature in features] for idx in range(NUM_RELATED_TRADES)])

RELATED_TRADE_BINARY_FEATURES = related_trade_features(RELATED_TRADE_BINARY_FEATURES)
RELATED_TRADE_CATEGORICAL_FEATURES = related_trade_features(RELATED_TRADE_CATEGORICAL_FEATURES) + related_trade_features(CATEGORICAL_REFERENCE_FEATURES_PER_RELATED_TRADE) + related_trade_features(['trade_type'])
RELATED_TRADE_NON_CAT_FEATURES = related_trade_features(RELATED_TRADE_NON_CAT_FEATURES)


COUPON_FREQUENCY_DICT = {0: 'Unknown', 
                         1: 'Semiannually', 
                         2: 'Monthly', 
                         3: 'Annually', 
                         4: 'Weekly', 
                         5: 'Quarterly', 
                         6: 'Every 2 years', 
                         7: 'Every 3 years', 
                         8: 'Every 4 years', 
                         9: 'Every 5 years', 
                         10: 'Every 7 years', 
                         11: 'Every 8 years', 
                         12: 'Biweekly', 
                         13: 'Changeable', 
                         14: 'Daily', 
                         15: 'Term mode', 
                         16: 'Interest at maturity', 
                         17: 'Bimonthly', 
                         18: 'Every 13 weeks', 
                         19: 'Irregular', 
                         20: 'Every 28 days', 
                         21: 'Every 35 days', 
                         22: 'Every 26 weeks', 
                         23: 'Not Applicable', 
                         24: 'Tied to prime', 
                         25: 'One time', 
                         26: 'Every 10 years', 
                         27: 'Frequency to be determined', 
                         28: 'Mandatory put', 
                         29: 'Every 52 weeks', 
                         30: 'When interest adjusts-commercial paper', 
                         31: 'Zero coupon', 
                         32: 'Certain years only', 
                         33: 'Under certain circumstances', 
                         34: 'Every 15 years', 
                         35: 'Custom', 
                         36: 'Single Interest Payment'}

LARGE_NUMBER = 1e6
VERY_LARGE_NUMBER = 1e9

COUPON_FREQUENCY_TYPE = {'Unknown': LARGE_NUMBER,
                         'Semiannually': 2,
                         'Monthly': 12,
                         'Annually': 1,
                         'Weekly': 52,
                         'Quarterly': 4,
                         'Every 2 years': 0.5,
                         'Every 3 years': 1/3,
                         'Every 4 years': 0.25,
                         'Every 5 years': 0.2,
                         'Every 7 years': 1/7,
                         'Every 8 years': 1/8,
                         'Every 10 years': 1/10,
                         'Biweekly': 26,
                         'Changeable': 44,
                         'Daily': 360,
                         'Interest at maturity': 0,
                         'Not Applicable':LARGE_NUMBER}

IDENTIFIERS = ['rtrs_control_number', 'cusip']

BINARY = ['callable',
          'sinking',
          'zerocoupon',
          'is_non_transaction_based_compensation',
          'is_general_obligation',
          'callable_at_cav',
          'extraordinary_make_whole_call',
          'make_whole_call',
          'has_unexpired_lines_of_credit',
          'escrow_exists']

CATEGORICAL_FEATURES = ['rating',
                        'incorporated_state_code',
                        'trade_type',
                        'purpose_class',
                        'max_ys_ttypes',
                        'min_ys_ttypes',
                        'max_qty_ttypes',
                        'min_ago_ttypes',
                        'D_min_ago_ttypes',
                        'P_min_ago_ttypes',
                        'S_min_ago_ttypes']

NON_CAT_FEATURES = ['quantity',
                     'days_to_maturity',
                     'days_to_call',
                     'coupon',
                     'issue_amount',
                     'last_seconds_ago',
                     'last_yield_spread',
                     'days_to_settle',
                     'days_to_par',
                     'maturity_amount',
                     'issue_price',
                     'orig_principal_amount',
                     'max_amount_outstanding',
                     'accrued_days',
                     'days_in_interest_payment',
                     'A/E',
                     'ficc_treasury_spread',
                     'max_ys_ys',
                     'max_ys_ago',
                     'max_ys_qdiff',
                     'min_ys_ys',
                     'min_ys_ago',
                     'min_ys_qdiff',
                     'max_qty_ys',
                     'max_qty_ago',
                     'max_qty_qdiff',
                     'min_ago_ys',
                     'min_ago_ago',
                     'min_ago_qdiff',
                     'D_min_ago_ys',
                     'D_min_ago_ago',
                     'D_min_ago_qdiff',
                     'P_min_ago_ys',
                     'P_min_ago_ago',
                     'P_min_ago_qdiff',
                     'S_min_ago_ys',
                     'S_min_ago_ago',
                     'S_min_ago_qdiff']

TRADE_HISTORY = ['trade_history', 'target_attention_features']
TARGET = ['yield_spread', 'calc_day_cat']

PREDICTORS = NON_CAT_FEATURES + BINARY + CATEGORICAL_FEATURES + TRADE_HISTORY

NON_CAT_FEATURES_DOLLAR_PRICE = ['quantity',
                                 'days_to_maturity',
                                 'days_to_call',
                                 'coupon',
                                 'issue_amount',
                                 'last_seconds_ago',
                                 'days_to_settle',
                                 'days_to_par',
                                 'maturity_amount',
                                 'issue_price',
                                 'orig_principal_amount',
                                 'max_amount_outstanding',
                                 'accrued_days',
                                 'days_in_interest_payment',
                                 'A/E',
                                 'max_dp_dp',
                                 'max_dp_ago',
                                 'max_dp_qdiff',
                                 'min_dp_dp',
                                 'min_dp_ago',
                                 'min_dp_qdiff',
                                 'max_qty_dp',
                                 'max_qty_ago',
                                 'max_qty_qdiff',
                                 'min_ago_dp',
                                 'min_ago_ago',
                                 'min_ago_qdiff',
                                 'D_min_ago_dp',
                                 'D_min_ago_ago',
                                 'D_min_ago_qdiff',
                                 'P_min_ago_dp',
                                 'P_min_ago_ago',
                                 'P_min_ago_qdiff',
                                 'S_min_ago_dp',
                                 'S_min_ago_ago',
                                 'S_min_ago_qdiff',
                                 'last_dollar_price']

BINARY_DOLLAR_PRICE = ['callable',
                       'sinking',
                       'zerocoupon',
                       'is_non_transaction_based_compensation',
                       'is_general_obligation',
                       'callable_at_cav',
                       'extraordinary_make_whole_call',
                       'make_whole_call',
                       'has_unexpired_lines_of_credit',
                       'escrow_exists']

CATEGORICAL_FEATURES_DOLLAR_PRICE = ['rating',
                                     'incorporated_state_code',
                                     'trade_type',
                                     'purpose_class',
                                     'max_dp_ttypes',
                                     'min_dp_ttypes',
                                     'max_qty_ttypes',
                                     'min_ago_ttypes',
                                     'D_min_ago_ttypes',
                                     'P_min_ago_ttypes',
                                     'S_min_ago_ttypes']

PREDICTORS_DOLLAR_PRICE = NON_CAT_FEATURES_DOLLAR_PRICE + BINARY_DOLLAR_PRICE + CATEGORICAL_FEATURES_DOLLAR_PRICE + ['target_attention_features', 'trade_history_dollar_price']

PURPOSE_CLASS_DICT = {1.0: 'Authority', 
                      2.0: 'Bond Anticipation Note', 
                      3.0: 'Building', 
                      4.0: 'Capital Loan Notes', 
                      5.0: 'Certificates Of Participation', 
                      6.0: 'Corporate Purpose', 
                      7.0: 'Drainage District', 
                      8.0: 'Economic Development Revenue', 
                      9.0: 'Education', 
                      10.0: 'Environment', 
                      11.0: 'Equipment', 
                      12.0: 'Federal Aid Note', 
                      13.0: 'Fire District', 
                      14.0: 'Flood Water Sewer Disposal', 
                      15.0: 'General Purpose', 
                      16.0: 'Grant Anticipation Note', 
                      17.0: 'Health', 
                      18.0: 'Housing', 
                      19.0: 'Improvement', 
                      20.0: 'Industrial Development Revenue', 
                      21.0: 'Library District', 
                      22.0: 'Metropolitan District', 
                      23.0: 'Miscellaneous', 
                      24.0: 'Municipal Bond Bank', 
                      25.0: 'Municipal Utilities District', 
                      26.0: 'Park District', 
                      27.0: 'Parking Authority', 
                      28.0: 'Pollution Control Revenue', 
                      29.0: 'Pool Financing Authority', 
                      30.0: 'Promissory Note', 
                      31.0: 'Public Housing Authority', 
                      32.0: 'Public Utility District', 
                      33.0: 'Racetrack/Casino', 
                      34.0: 'Recreation Authority', 
                      35.0: 'Revenue Anticipation Note', 
                      36.0: 'Sanitation District', 
                      37.0: 'School District', 
                      38.0: 'Special Assessment', 
                      39.0: 'Special Obligation', 
                      40.0: 'State and Federal Anticipation Note', 
                      41.0: 'State and Grant Anticipation Note', 
                      42.0: 'State Anticipation Notes', 
                      43.0: 'State Store', 
                      44.0: 'Tax and Revenue Anticipation', 
                      45.0: 'Tax Anticipation Note', 
                      46.0: 'Tax Revenue', 
                      47.0: 'Temporary Notes', 
                      48.0: 'Transportation', 
                      49.0: 'Tribal Bonds', 
                      50.0: 'Utility', 
                      51.0: 'Various Purpose', 
                      52.0: 'Veterans', 
                      53.0: 'Warrants'}

PURPOSE_SUB_CLASS_DICT = {1.0: 'None', 
                          2.0: 'Acute Care', 
                          3.0: 'Air Transport', 
                          4.0: 'Aircraft (Mnfc/Supplies)', 
                          5.0: 'Airline/Airport', 
                          6.0: 'Assisted Living', 
                          7.0: 'Atmosphere/Space', 
                          8.0: 'Authority', 
                          9.0: 'Automotive (Mnfc/Supplies)', 
                          10.0: 'Bridge and Toll Road', 
                          11.0: 'Building', 
                          12.0: 'Building Supplies', 
                          13.0: 'Bus', 
                          14.0: 'Cement', 
                          15.0: 'Chemical', 
                          16.0: 'College', 
                          17.0: 'Combined', 
                          18.0: 'Computer (Mnfc/Supplies)', 
                          19.0: 'Construction', 
                          20.0: 'Continuing Care Retirement Center', 
                          21.0: 'Convention Center', 
                          22.0: 'Correctional Facility', 
                          23.0: 'Delinquent (Property Tax)', 
                          24.0: 'Development', 
                          25.0: 'District', 
                          26.0: 'Economic Development', 
                          27.0: 'Education', 
                          28.0: 'Electric', 
                          29.0: 'Energy Conservation', 
                          30.0: 'Environment', 
                          31.0: 'Equipment', 
                          32.0: 'Excise Tax (Sales Beer Luxury)', 
                          33.0: 'Facility', 
                          34.0: 'Financial', 
                          35.0: 'Fire', 
                          36.0: 'Flood', 
                          37.0: 'Food Products', 
                          38.0: 'Franchise Tax', 
                          39.0: 'Freight Forwarding', 
                          40.0: 'Furniture', 
                          41.0: 'Gaming', 
                          42.0: 'General Utility', 
                          43.0: 'Golf', 
                          44.0: 'Harbor/Channel', 
                          45.0: 'Health', 
                          46.0: 'Highway (No Toll Is Paid)', 
                          47.0: 'Hospital', 
                          48.0: 'Hospital System Bonds', 
                          49.0: 'Hotel/Motel/Inn', 
                          50.0: 'Housing', 
                          51.0: 'Improvement', 
                          52.0: 'Industrial Development', 
                          53.0: 'Lease', 
                          54.0: 'Life Care', 
                          55.0: 'Liquor (Ohio)', 
                          56.0: 'Lumber', 
                          57.0: 'Mall', 
                          58.0: 'Manufacturing', 
                          59.0: 'Marine Terminal', 
                          60.0: 'Mass Transit', 
                          61.0: 'Metal (Mnfc/Supplies)', 
                          62.0: 'Mining', 
                          63.0: 'Motor', 
                          64.0: 'Multi', 
                          65.0: 'Municipal', 
                          66.0: 'Natural Gas', 
                          67.0: 'Non-Profit', 
                          68.0: 'Nuclear', 
                          69.0: 'Nursing Home', 
                          70.0: 'Office', 
                          71.0: 'Oil/Gas', 
                          72.0: 'Osteopathic', 
                          73.0: 'Paper/Forest Products', 
                          74.0: 'Parking Authority/Garage', 
                          75.0: 'Pharmaceutical', 
                          76.0: 'Plastics', 
                          77.0: 'Pollution Control', 
                          78.0: 'Pooled Financing', 
                          79.0: 'Port Authority', 
                          80.0: 'Power', 
                          81.0: 'Preservation/Conservation', 
                          82.0: 'Private College', 
                          83.0: 'Psychiatric', 
                          84.0: 'Public Facilities Authority', 
                          85.0: 'Public Finance Authority', 
                          86.0: 'Public Power/Utility', 
                          87.0: 'Public University', 
                          88.0: 'Publishing', 
                          89.0: 'Railroad', 
                          90.0: 'Real Estate', 
                          91.0: 'Recreational Facility', 
                          92.0: 'Recycling', 
                          93.0: 'Redevelopment', 
                          94.0: 'Rehabilitation', 
                          95.0: 'Resource Recovery', 
                          96.0: 'Restaurant', 
                          97.0: 'Restaurant', 
                          98.0: 'Retail', 
                          99.0: 'Roadway/Street', 
                          100.0: 'Rubber', 
                          101.0: 'School', 
                          102.0: 'Senior Housing', 
                          103.0: 'Services', 
                          104.0: 'Sewer', 
                          105.0: 'Shipping', 
                          106.0: 'Single', 
                          107.0: 'Solid Waste Disposal', 
                          108.0: 'Special Tax', 
                          109.0: 'Stadium', 
                          110.0: 'State Appropriated Tobacco', 
                          111.0: 'Steel', 
                          112.0: 'Student Loan', 
                          113.0: 'Supermarket', 
                          114.0: 'Tax Allocation', 
                          115.0: 'Tax Increment', 
                          116.0: 'Technology', 
                          117.0: 'Telecommunication', 
                          118.0: 'Tobacco', 
                          119.0: 'Transportation', 
                          120.0: 'Trucking', 
                          121.0: 'Turnpike', 
                          122.0: 'University', 
                          123.0: 'Utility', 
                          124.0: 'Various Purpose', 
                          125.0: 'Water', 
                          126.0: 'Charter School', 
                          127.0: 'Lottery', 
                          128.0: 'Student Housing', 
                          129.0: 'Water & Sewer'}

MUNI_ISSUE_TYPE_DICT = {1.0: 'Build America Bonds Direct Pay', 
                        2.0: 'Build America Bonds Tax Credit', 
                        3.0: 'New Clean Renewable Energy Bonds Tax Credit', 
                        4.0: 'New Clean Renewable Energy Bonds Direct Pay', 
                        5.0: 'Qualified Energy Conservation Bonds Tax Credit', 
                        6.0: 'Qualified Energy Conservation Bonds Direct Pay', 
                        7.0: 'Qualified School Construction Bonds Tax Credit', 
                        8.0: 'Qualified  School Construction Bonds Direct Pay', 
                        9.0: 'Qualified Zone Academy Bonds Tax Credit', 
                        10.0: 'Qualified Zone Academy Bonds Direct Pay', 
                        11.0: 'Recovery Zone Econ Dev Build America Bonds Direct Pay', 
                        12.0: 'Recovery Zone Facilities Bonds', 
                        13.0: 'Tribal Economic Development Bonds', 
                        14.0: 'Green Bonds', 
                        15.0: 'Municipal Liquidity Facility', 
                        16.0: 'Property Assessed Clean Energy'}

SALE_TYPE_DICT = {0: 'Unknown', 
                  1: 'Competitive', 
                  2: 'Negotiated', 
                  3: 'Limited', 
                  4: 'Private placement', 
                  5: 'Remarketing'}

ORIG_INSTRUMENT_ENHANCEMENT_TYPE_DICT = {1.0: 'Custodial receipt', 
                                         2.0: 'Periodic auction/inverse floater', 
                                         3.0: 'Prem municipal bond receipt', 
                                         4.0: 'Pre-refunded', 
                                         5.0: 'Third party put/tender option bond', 
                                         6.0: 'Remarketing', 
                                         7.0: 'Secondarily insured', 
                                         8.0: 'Unit put & secondarily insured', 
                                         9.0: 'Third party put unit', 
                                         10.0: 'Unrefunded balance'}

OTHER_ENHANCEMENT_TYPE_DICT = {0.0: 'Unknown',
                               1.0: 'GIC with',
                               2.0: 'State guaranteed',
                               3.0: 'State qualified school aid (MI, NJ, PA Only)',
                               4.0: 'Certificate of Deposit-FDIC',
                               5.0: 'Certificate of Deposit-FSLIC',
                               6.0: 'Guaranteed by',
                               7.0: 'City or County Gtd',
                               8.0: 'Guaranteed by the U.S. government',
                               9.0: 'Loan purchase agreement',
                               10.0: 'Certificate of Deposit-FDIC & FSLIC',
                               11.0: 'Bankers Acceptance',
                               12.0: 'Collateralized purchase agreement',
                               13.0: 'Qualified municipal bonds',
                               14.0: 'Gtd: Nat Rural Utilities Co-op Fin Corp',
                               15.0: 'State pool inv fd gtd',
                               16.0: 'Reinsurance',
                               17.0: 'Parent CUSIP insured',
                               18.0: 'State school aid program',
                               19.0: 'Loans to lenders agreement',
                               20.0: 'Minn School Dist enh program',
                               21.0: 'Permanent school fund guaranteed (TX Only)',
                               22.0: 'Parent CUSIP Gtd',
                               23.0: 'Parent CUSIP enh by LOC',
                               24.0: 'Parent CUSIP partially refunded',
                               25.0: 'Print paid by U.S. govs in escrow',
                               26.0: 'GTD Student loans',
                               27.0: 'Print paid by oblig of Inter. Bk for Reconst & Dev',
                               28.0: 'Utah State School Ins',
                               29.0: 'Prepaid gas contract',
                               30.0: 'Prepaid electric contract',
                               31.0: 'Tobacco settlement',
                               32.0: 'Miss Adequate Educ program (MAEP)',
                               33.0: 'Collateralized',
                               34.0: 'ARKANSAS SCHOOL DISTRICT ENHANCEMENT PROGRAM',
                               35.0: 'CALIFORNIA INFRASTRUCTURE BK SCH AID INTERCEPT PG',
                               36.0: 'COLORADO SCHOOL DISTRICT ENHANCEMENT PROGRAM',
                               37.0: 'COLORADO HIGHER EDUCATION ENHANCEMENT PROGRAM',
                               38.0: 'GEORGIA SCHOOL DISTRICT INTERCEPT PROGRAM',
                               39.0: 'IDAHO SCHOOL BOND GUARANTY PROGRAM',
                               40.0: 'INDIANA SCHOOL DISTRICT ENHANCEMENT PROGRAM',
                               41.0: 'KENTUCKY PUBLIC UNIVERSITY INTERCEPT PROGRAM',
                               42.0: 'KENTUCKY SCHOOL DISTRICT ENHANCEMENT PROGRAM',
                               43.0: 'MASSACHUSETTS QUALIFIED BOND PROGRAM',
                               44.0: 'MARYLAND INFRASTRUCTURE FINANCING INTERCEPT PROG',
                               45.0: 'MICHIGAN SCHOOL BOND QUAL & LOAN PROG',
                               46.0: 'MINNESOTA CREDIT ENHANCEMENT PROGRAM',
                               47.0: 'MISSOURI DIRECT DEPOSIT AGREEMENT INTERCEPT PROG',
                               48.0: 'NORTH DAKOTA DEPT OF PUB INSTR SCH DIST CRED ENH',
                               49.0: 'NEW JERSEY SCHOOL BOND RESERVE ACT',
                               50.0: 'NEW JERSEY MUNICIPAL QUALIFIED BOND PROGRAM',
                               51.0: 'NEW MEXICO SCHOOL DISTRICT ENHANCEMENT PROGRAM',
                               52.0: 'NEVADA SCHOOL DISTRICT BOND GUARANTEE PROGRAM',
                               53.0: 'DASNY OMRDD INTERCEPT PROGRAM',
                               54.0: 'DASNY MASTER BOCES PROGRAM',
                               55.0: 'DASNY COURT FACILITIES PROGRAM',
                               56.0: 'DASNY MUNICIPAL HEALTH FACILITIES PROGRAM',
                               57.0: 'DASNY SCHOOL DISTRICT REVENUE BOND FINANCING PROG',
                               58.0: 'NEW YORK STATE SECTION 99 B INTERCEPT PROGRAM',
                               59.0: 'OHIO SCHOOL DISTRICT CREDIT ENHANCEMENT PROGRAM',
                               60.0: 'OHIO TECHNICAL AND COMMUNITY COLLEGE PROGRAM',
                               61.0: 'OREGON PENSION OBLIGATION STATE INTERCEPT PROGRAM',
                               62.0: 'PENNSYLVANIA ST PUB SCH BLDG AUTH LEASE INTERCEPT',
                               63.0: 'PENNSYLVANIA SCH DIST FISCAL AGENT AGRMT INTERCEPT',
                               64.0: 'PENNSYLVANIA ACT 150 SCH DIST INTERCEPT PROG',
                               65.0: 'RHODE ISLAND HLTH AND EDUC BLDG CORP INTERCEPT',
                               66.0: 'RHODE ISLAND HEBC 6 MONTH INTERCEPT PROGRAM',
                               67.0: 'SOUTH CAROLINA SCH DIST CREDIT ENHANCEMENT PROG',
                               68.0: 'TENNESSEE ST SCH BOARD AUTH HIGHER ED INTERCEPT',
                               69.0: 'TENNESSEE STATE SCH BOND AUTHORITY INTERCEPT PROG',
                               70.0: 'TEXAS HIGHER EDUCATION BOND PROGRAM',
                               71.0: 'VIRGINIA LOCALITIES INTERCEPT PROGRAM',
                               72.0: 'WEST VIRGINIA MUNICIPAL BOND COMMISSION PROGRAM',
                               73.0: 'WYOMING SCHOOL DISTRICT BOND GUARANTEE PROGRAM',
                               74.0: 'MICHIGAN STATE SCHOOL BOND LOAN FUND PROGRAM',
                               75.0: 'OREGON SCHOOL BOND GUARANTEE PROGRAM',
                               76.0: 'WASHINGTON SCHOOL BOND GUARANTY PROGRAM',
                               77.0: 'NEW JERSEY COUNTY COLLEGE ENHANCEMENT BOND PROGRAM',
                               78.0: 'ARKANSAS SCHOOL DISTRICT ENH PROGRAM (PRE-DEFAULT)',
                               79.0: 'IDAHO SALES TAX GUARANTY PROGRAM',
                               80.0: 'STATE OF OKLAHOMA CREDIT ENH RESERVE FD GUARANTEE',
                               81.0: 'Vermont State Aid Intercept Program',
                               82.0: 'SOUTH DAKOTA ST AID INTERCEPT PROG',
                               83.0: 'NEW JERSEY SCH DIST ENHANCEMENT PROG CHAPTER 72',
                               84.0: 'NEW JERSEY QUALIFIED SCHOOL BOND PROGRAM',
                               85.0: 'NEW JERSEY SCH DIST ENHANCEMENT PROG - CHAPTER 74',
                               86.0: 'OKLAHOMA SCH DIST BOND GUARANTEE PROGRAM',
                               87.0: 'SOUTH DAKOTA SCH DIST CAPITAL OUTLAY LEASE PROGRAM',
                               88.0: 'CALIFORNIA MOTOR VEHICLE LICENSE FEE PROG',
                               89.0: 'CALIFORNIA ST TEACHERS RETIREMENT SYS',
                               90.0: 'OHIO MARKET ACCESS PROGRAM',
                               91.0: 'ARIZONA PUBLIC SCHOOL CREDIT ENHANCEMENT PROGRAM',
                               92.0: 'MICHIGAN CNTYS DISTRIBUTABLE ST AID INTERCEPT PROG',
                               93.0: 'CITY OF DETROIT DISTRIBUTABLE ST AID INTERCEPT PG',
                               94.0: 'OTHER ENH TYPE',
                               95.0: 'UTAH CHARTER SCHOOL CREDIT ENHANCEMENT PROGRAM'}

CAPITAL_TYPE_DICT = {0: 'Unknown', 
                     1: 'Refunding', 
                     2: 'Advanced refunding', 
                     3: 'Advanced refunding/New financing', 
                     4: 'Current refunding', 
                     5: 'Current refunding/New financing', 
                     6: 'New financing', 
                     7: 'Cross-over refinancing', 
                     8: 'Remarketing/Conversion', 
                     9: 'Remarketed/Converted', 
                     10: 'Restructured debt', 
                     11: 'Muni forward', 
                     12: 'Sale canceled', 
                     13: 'Escrow receipt-Pur Muni forward', 
                     14: 'Sale postponed', 
                     99: 'Null value'}

ASSET_CLAIM_CODE_DICT = {1.0: 'Junior Lien', 
                         2.0: 'Junior Subordinate Lien', 
                         3.0: 'Senior Lien', 
                         4.0: 'Senior Subordinate Lien', 
                         5.0: 'Subordinate Lien'}

MUNI_SECURITY_TYPE_DICT = {0: 'Unknown', 
                           1: 'Special assessment', 
                           2: 'Double barreled', 
                           3: 'Lease-rental', 
                           4: 'Fuel/vehicle tax', 
                           5: 'Unlimited G.O.', 
                           6: 'Limited G.O.', 
                           7: 'Other', 
                           8: 'Revenue', 
                           9: 'Sales/excise tax', 
                           10: 'Tax allocation/increment', 
                           11: 'U.S. government-backed', 
                           12: 'Tobacco state appropriated', 
                           13: 'Tobacco settlement non-appropriated', 
                           14: 'Federal grant', 
                           15: 'Cigarette tax', 
                           16: 'Hotel tax', 
                           17: 'Miscellaneous tax', 
                           18: 'Personal income tax', 
                           19: 'Pilot'}

USE_OF_PROCEEDS_DICT = {0: 'Unknown', 
                        1: 'Single-family housing', 
                        2: 'Multi-family housing', 
                        3: 'Single/multi-family housing', 
                        4: 'New public housing', 
                        5: 'CMO-backed housing', 
                        6: 'Senior housing independent living', 
                        7: 'Student housing', 
                        8: 'Other housing', 
                        9: 'Primary/secondary education', 
                        10: 'Higher education', 
                        11: 'Student loans', 
                        12: 'Libraries or museums', 
                        13: 'Private higher education', 
                        14: 'Public higher education', 
                        15: 'Charter school', 
                        16: 'Other education', 
                        17: 'Government/public buildings', 
                        18: 'Fire station/equipment', 
                        19: 'Correction facilities/courts', 
                        20: 'General purpose/public impt', 
                        21: 'Police station/equipment', 
                        22: 'Redevelopment/land clearance', 
                        23: 'Land preservation', 
                        24: 'Other public service', 
                        25: 'Military housing', 
                        26: 'Public human service provider', 
                        27: 'Mobile Home', 
                        28: 'Hospitals', 
                        29: 'Hospital equipment loans', 
                        31: 'Lifecare/retirement centers', 
                        32: 'Nursing homes', 
                        33: 'Other health care', 
                        34: 'Industrial development', 
                        35: 'Pollution control', 
                        36: 'Solid waste/res recovery', 
                        37: 'Economic development', 
                        38: 'Office building/limited partnerships', 
                        39: 'Malls/shopping centers', 
                        40: 'Secured airlines', 
                        41: 'Unsecured airlines', 
                        42: 'Other industrial development', 
                        43: 'Private human service provider', 
                        44: 'Hotel', 
                        45: 'Civic/convention centers', 
                        46: 'Stadiums/sports complex', 
                        47: 'Theaters', 
                        48: 'Parks/zoos/beaches', 
                        49: 'Other recreation', 
                        50: 'Airports', 
                        51: 'Seaports/marine terminals', 
                        52: 'Streets/highways', 
                        53: 'Bridges', 
                        54: 'Tunnels', 
                        55: 'Parking facilities', 
                        56: 'Mass/rapid transit', 
                        57: 'Toll road', 
                        58: 'Other transportation', 
                        59: 'Electric & public power', 
                        60: 'Water & sewer', 
                        61: 'Gas', 
                        62: 'Telephone', 
                        63: 'Sanitation', 
                        64: 'Flood control/storm drain', 
                        65: 'Combined utilities', 
                        66: 'Water', 
                        67: 'Other utilities', 
                        68: 'Sewer', 
                        69: 'Cogeneration', 
                        70: 'Veterans', 
                        71: 'Agriculture', 
                        72: 'Irrigation', 
                        73: 'Other Post Employee Benefits', 
                        74: 'Pension Obligation'}

SECURED_DICT = {1.0: 'Collateralized', 
                2.0: 'Secured', 
                3.0: 'Uncollateralized', 
                4.0: 'Unsecured'}

STATE_TAX_STATUS_DICT = {0.0: 'Unknown',
                         1.0: 'Tax exempt',
                         2.0: 'No indication in the Official Statement',
                         3.0: 'Taxable'}

EVENT_CODE_DICT = {1: 'Monetary default', 
                   2: 'Continuing disclosure', 
                   3: 'Defeasance', 
                   4: 'Technical default', 
                   5: 'Financials filed', 
                   6: 'Fitch rating conditional', 
                   7: 'Fitch rating downgrade', 
                   8: 'Fitch rating upgrade', 
                   9: 'Fitch short term rating conditional', 
                   10: 'Fitch short term rating downgrade', 
                   11: 'Fitch short term rating upgrade', 
                   12: 'Full redemption', 
                   13: 'LOC change', 
                   14: 'LOC expiration change', 
                   15: 'Moodys rating conditional', 
                   16: 'Moodys rating downgrade', 
                   17: 'Moodys rating upgrade', 
                   18: 'Moodys short term rating conditional', 
                   19: 'Moodys short term rating downgrade', 
                   20: 'Moodys short term rating upgrade', 
                   21: 'Default status', 
                   22: 'Official statement received', 
                   23: 'Other material event', 
                   24: 'Partial distribution', 
                   25: 'Partial redemption', 
                   26: 'Bondholder rights', 
                   27: 'Collateral change', 
                   28: 'S&P rating downgrade', 
                   29: 'S&P rating provisional', 
                   30: 'S&P rating upgrade', 
                   31: 'S&P short term rating downgrade', 
                   32: 'S&P short term rating provisional', 
                   33: 'S&P short term rating upgrade', 
                   34: 'Scheduled redemption', 
                   35: 'Tax status', 
                   36: 'Unscheduled redemption', 
                   37: 'Change in accounting standard', 
                   38: 'Bid for auction rate or other securities', 
                   39: 'Budget', 
                   40: 'Consultant report', 
                   41: 'Derivative or other similar transaction', 
                   42: 'Failure to provide annual financial information', 
                   43: 'Failure to provide event filing information', 
                   44: 'Capital or other financing plan', 
                   45: 'Change in fiscal year timing of annual disclosure', 
                   46: 'Interim additional financial information operating data', 
                   47: 'Investment debt financial policy', 
                   48: 'Quarterly monthly financial information', 
                   49: 'Information to rating agency, liquidity provider or third party', 
                   50: 'Tender offer secondary market purchases', 
                   51: 'Change of tender, remarketing agent or other agent', 
                   52: 'Successor, additional or change in trustee', 
                   53: 'Unscheduled Draw from Credit Enhancement', 
                   54: 'Substitution Of Credit or Liquidity Provider', 
                   55: 'Financial Obligation Incurrence', 
                   56: 'Fin Oblig Event Reflecting Financial Difficulties', 
                   57: 'Financial Obligation Incurrence Debt Obligation', 
                   58: 'Financial Oblig Incurrence Guarantee Debt Oblig', 
                   59: 'Finan Oblig Incurrence Guarantee Derivative Instr', 
                   60: 'Financial Oblig Incurrence Derivative Instrument', 
                   61: 'Finan Oblig Event Reflect Fin Difficulties Default', 
                   62: 'Fin Oblig Event Reflect Fin Diff Event Of Accel', 
                   63: 'Fin Oblig Event Reflect Fin Diff Termination Event', 
                   64: 'Finan Oblig Event Reflect Fin Diff Modif Of Terms', 
                   65: 'Finan Oblig Event Reflect Finan Diff Other', 
                   66: 'Initial Asset Backed Securities Disclosure', 
                   67: 'Quarterly Asset Backed Securities Disclosure', 
                   68: 'Annual Asset Backed Securities Disclosure', 
                   69: 'Other Asset Backed Securities Disclosure', 
                   70: 'Bank Loan Alternative Financing Filings'}
